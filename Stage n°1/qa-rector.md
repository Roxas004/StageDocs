# Rector

This document outlines best practices and conventions for using [Rector](https://getrector.com/) in project development.

Rector is a tool for automating PHP code refactoring and upgrades. It allows you to apply migration, modernization, and code-cleaning rules in a systematic and reproducible way. The following sections detail configuration management, command execution, contributing custom rules, and provide concrete examples.

## 1. Configuration Management

- **Main file**: Rectorâ€™s configuration is located in the `rector.php` file at the root of the project.
- **Organization**: Rules are organized by migration type (PHP version upgrade, framework migration, custom rules, etc.).
- **Versioning**: Any modification to the configuration file must be reviewed and committed separately.

## 2. Running Commands

To analyze or fix code, use the following commands:

- **Analysis without modification**:
    ```
    vendor/bin/rector process src --dry-run
    ```
    This command shows the changes that would be applied without modifying any files.

- **Targeting a specific file or folder**:
    ```
    vendor/bin/rector process src/MyFile.php
    ```

## 3. Contribution and Customization

- **Adding custom rules**: Add your rules in the `rector.php` file following the existing structure.
- **Tests**: Every new rule must be covered by automated tests (see the `tests/Rector` folder).

## 4. Best Practices

- **Dedicated commits**: Each batch of changes generated by Rector should be isolated in a separate commit with an explicit message (e.g., `chore(rector): apply Rector rules for PHP 8.2`).
- **Code review**: Automated changes should always be reviewed before being merged.
- **Regular updates**: Keep Rector and its rules up to date to benefit from the latest improvements.

  ## 5. Advanced Configuration Options

- **Listing Available Rules and SetLists**:  
  Rector provides several preconfigured sets of rules (SetLists) that you can apply to your project:
  - `SetList::PHP_82`: Modernizes your code according to the PHP 8.2 standards.  
    *(Worth it because it ensures you take advantage of the latest PHP features.)*
  - `SetList::CODE_QUALITY`: Improves code quality, readability, and maintainability.  
    *(Useful to enforce best coding practices across the project.)*
  - `SetList::DEAD_CODE`: Detects and removes unused or unreachable code.  
    *(Helps maintain a clean and efficient codebase.)*
  - `SetList::TYPE_DECLARATION`: Enforces strict type declarations for improved type safety.  
    *(Reduces runtime errors by taking full advantage of PHP's type system.)*
  - `SetList::CODING_STYLE`: Refactors code to follow consistent coding styles and conventions.  
    *(Enhances readability and uniformity across the project.)*
  
  To view the complete list of available SetLists, refer to the Rector documentation or run:
  ```bash
  vendor/bin/rector list --set-lists
  ```

- **PHP Version Configuration**:  
  In your `rector.php` configuration file, you can specify the PHP version target by importing the appropriate SetList (e.g., `SetList::PHP_82`). This ensures that your code is adjusted to the expected PHP version during modernization.

- **Cache for Improved Performance**:  
  Rector uses caching by default to improve performance by skipping unchanged files. If necessary, you can disable caching with the `--no-cache` option to force a full analysis.

- **Integration with PHPStan**:  
  Rector can be integrated with PHPStan for a more robust static code analysis. Combining both tools allows you to benefit from automated refactoring and detailed analysis of code quality and potential issues.

  